"0","sensitivity.mnl <- function(model, attrib, base.data, competitor.data) {"
"0","  # Function for creating data for a preference share-sensitivity chart"
"0","  # model: mlogit object returned by mlogit() function"
"0","  # attrib: list of vectors with attribute levels to be used in sensitivity"
"0","  # base.data: data frame containing baseline design of target product"
"0","  # competitor.data: data frame contining design of competitive set"
"0","  data <- rbind(base.data, competitor.data)"
"0","  base.share <- predict.mnl(model, data)[1,1]"
"0","  share <- NULL"
"0","  for (a in seq_along(attrib)) {"
"0","    for (i in attrib[[a]]) {"
"0","      data[1,] <- base.data"
"0","      data[1,a] <- i"
"0","      share <- c(share, predict.mnl(model, data)[1,1])"
"0","    }"
"0","  }"
"0","  data.frame(level=unlist(attrib), share=share, increase=share-base.share)"
"0","}"
"0",""
"0","base.data <- profiles[5,]"
"0","competitor.data <- profiles[-5,]"
"0","tradeoff <- sensitivity.mnl(lm2, attributes, base.data, competitor.data)"
